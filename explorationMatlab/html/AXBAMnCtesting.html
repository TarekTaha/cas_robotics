
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>AXBAMnCtesting</title>
      <meta name="generator" content="MATLAB 7.4">
      <meta name="date" content="2008-06-19">
      <meta name="m-file" content="AXBAMnCtesting"><style>

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content">
         <h2>Contents</h2>
         <div>
            <ul>
               <li><a href="#2">plot the current mesh and robot</a></li>
               <li><a href="#3">plot the current classification and robot</a></li>
               <li><a href="#4">save the workspace data file at that point</a></li>
               <li><a href="#5">plot directed C</a></li>
            </ul>
         </div><pre class="codeinput"><span class="keyword">function</span> AXBAMnCtesting(plotdirectedC)
<span class="comment">%plot the current mesh and robot</span>
<span class="keyword">global</span> r Q robmap_h workspace
<span class="keyword">if</span> nargin==0
    plotdirectedC=input(<span class="string">'Do you want to plot the directed classification? 1=Yes, 0=No'</span>);
    <span class="keyword">try</span> <span class="keyword">if</span> plotdirectedC~=1 &amp;&amp; plotdirectedC~=0
        plotdirectedC=false;
        <span class="keyword">end</span>
    <span class="keyword">catch</span>;
        plotdirectedC=false;
    <span class="keyword">end</span>
<span class="keyword">end</span>

testnum= input(<span class="string">'Please enter TEST number'</span>,<span class="string">'s'</span>);
scannum= input(<span class="string">'Please enter SCAN number'</span>,<span class="string">'s'</span>);
plotunknown=input(<span class="string">'Do you want to plot the unknown voxels 1=yes, 0=no'</span>);

testdir=<span class="string">'C:\Documents and Settings\RTA computer\My Documents\My Pictures\'</span>;
</pre><h2>plot the current mesh and robot<a name="2"></a></h2><pre class="codeinput">figure
plotdenso(r,Q)
camlight
aabb = [-1.5, -1.5, -1; 2, 1.5, 2];
hMesh = robmap_h.Mesh(aabb);
f = hMesh.FaceData;
v = hMesh.VertexData;
hold <span class="string">on</span>;
guiglobal.mesh_h=trisurf(f, v(:,1), v(:,2), v(:,3), <span class="string">'FaceColor'</span>, <span class="string">'None'</span>);
axis <span class="string">equal</span>
view(116,18)
saveas(gcf,[testdir,<span class="string">'AXBAMnC_Test'</span>,testnum,<span class="string">'Scan'</span>,scannum,<span class="string">'_meshNrobot.fig'</span>]);
close <span class="string">gcf</span>
</pre><h2>plot the current classification and robot<a name="3"></a></h2><pre class="codeinput">figure
plotdenso(r,Q)
camlight
class_cubesize=workspace.class_cubesize;

    <span class="comment">%determine the unknown places and the know metal or wood</span>
sumofclass=workspace.ocgrid(:,4)+workspace.ocgrid(:,5);
warning(<span class="string">'off'</span>,<span class="string">'MATLAB:divideByZero'</span>)
<span class="keyword">try</span> classifiedvoxels=find(sumofclass&gt;=workspace.minclassifications &amp;<span class="keyword">...</span>
                     (workspace.ocgrid(:,4)./workspace.ocgrid(:,5)&gt;workspace.classfierthreshhold |<span class="keyword">...</span>
                      workspace.ocgrid(:,5)./workspace.ocgrid(:,4)&gt;workspace.classfierthreshhold));<span class="keyword">end</span>
<span class="keyword">try</span> UNclassifiedvoxels=find(sumofclass&lt;workspace.minclassifications | <span class="keyword">...</span>
                     (workspace.ocgrid(:,4)./workspace.ocgrid(:,5)&lt;=workspace.classfierthreshhold &amp;<span class="keyword">...</span>
                      workspace.ocgrid(:,5)./workspace.ocgrid(:,4)&lt;=workspace.classfierthreshhold));<span class="keyword">end</span>
warning(<span class="string">'on'</span>,<span class="string">'MATLAB:divideByZero'</span>)

    <span class="comment">%now plot this</span>
hold <span class="string">on</span>;
<span class="keyword">if</span> plotunknown
    <span class="keyword">try</span> plot3(workspace.ocgrid(UNclassifiedvoxels,1)*class_cubesize,<span class="keyword">...</span>
          workspace.ocgrid(UNclassifiedvoxels,2)*class_cubesize,<span class="keyword">...</span>
          workspace.ocgrid(UNclassifiedvoxels,3)*class_cubesize,<span class="string">'y'</span>,<span class="string">'marker'</span>,<span class="string">'.'</span>,<span class="string">'markersize'</span>,0.5,<span class="string">'linestyle'</span>,<span class="string">'none'</span>);<span class="keyword">end</span>
<span class="keyword">end</span>
<span class="comment">%plot metal and wood voxels</span>

metalvoxels=workspace.ocgrid(classifiedvoxels(workspace.ocgrid(classifiedvoxels,4)&gt;workspace.ocgrid(classifiedvoxels,5)),1:3);
<span class="keyword">if</span> size(metalvoxels,1)&gt;0
    <span class="keyword">try</span> plot3(metalvoxels(:,1)*class_cubesize,metalvoxels(:,2)*class_cubesize,metalvoxels(:,3)*class_cubesize,<span class="string">'r.'</span>);<span class="keyword">end</span>
<span class="keyword">end</span>

woodvoxels=workspace.ocgrid(classifiedvoxels(workspace.ocgrid(classifiedvoxels,4)&lt;workspace.ocgrid(classifiedvoxels,5)),1:3);
<span class="keyword">if</span> size(woodvoxels,1)&gt;0
    <span class="keyword">try</span> plot3(woodvoxels(:,1)*class_cubesize,woodvoxels(:,2)*class_cubesize,woodvoxels(:,3)*class_cubesize,<span class="string">'b.'</span>);<span class="keyword">end</span>
<span class="keyword">end</span>


axis <span class="string">equal</span>
view(116,18)
saveas(gcf,[testdir,<span class="string">'AXBAMnC_Test'</span>,testnum,<span class="string">'Scan'</span>,scannum,<span class="string">'_classNrobot.fig'</span>]);
close <span class="string">gcf</span>
</pre><h2>save the workspace data file at that point<a name="4"></a></h2><pre class="codeinput">save([testdir,<span class="string">'AXBAMnC_Test'</span>,testnum,<span class="string">'Scan'</span>,scannum,<span class="string">'_workspaceSTATE.mat'</span>],<span class="string">'workspace'</span>);
</pre><h2>plot directed C<a name="5"></a></h2><pre class="codeinput"><span class="keyword">global</span> AXBAMnCtestdata
<span class="keyword">if</span> plotdirectedC &amp;&amp; ~isempty(AXBAMnCtestdata)
<span class="comment">%after (uses previous steps found metal and wood)</span>
    figure
    plotdenso(r,AXBAMnCtestdata.newQ)
    camlight
    plotfill=false;
    plot_planes(AXBAMnCtestdata.plane_aimed_at,AXBAMnCtestdata.mew,plotfill);
    hold <span class="string">on</span>;
    plot3(AXBAMnCtestdata.plane_aimed_at.home_point(1),AXBAMnCtestdata.plane_aimed_at.home_point(2),AXBAMnCtestdata.plane_aimed_at.home_point(3),<span class="string">'b*'</span>);
    plot3([AXBAMnCtestdata.plane_aimed_at.home_point(1),AXBAMnCtestdata.plane_aimed_at.home_point(1)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(1)/10],<span class="keyword">...</span>
          [AXBAMnCtestdata.plane_aimed_at.home_point(2),AXBAMnCtestdata.plane_aimed_at.home_point(2)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(2)/10],<span class="keyword">...</span>
          [AXBAMnCtestdata.plane_aimed_at.home_point(3),AXBAMnCtestdata.plane_aimed_at.home_point(3)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(3)/10],<span class="string">'b'</span>);
    <span class="keyword">if</span> plotunknown
        <span class="keyword">try</span> plot3(workspace.ocgrid(UNclassifiedvoxels,1)*class_cubesize,<span class="keyword">...</span>
          workspace.ocgrid(UNclassifiedvoxels,2)*class_cubesize,<span class="keyword">...</span>
          workspace.ocgrid(UNclassifiedvoxels,3)*class_cubesize,<span class="string">'y'</span>,<span class="string">'marker'</span>,<span class="string">'.'</span>,<span class="string">'markersize'</span>,0.5,<span class="string">'linestyle'</span>,<span class="string">'none'</span>);<span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="keyword">if</span> size(metalvoxels,1)&gt;0;<span class="keyword">try</span> plot3(metalvoxels(:,1)*class_cubesize,metalvoxels(:,2)*class_cubesize,metalvoxels(:,3)*class_cubesize,<span class="string">'r.'</span>);<span class="keyword">end</span>; <span class="keyword">end</span>
    <span class="keyword">if</span> size(woodvoxels,1)&gt;0;<span class="keyword">try</span> plot3(woodvoxels(:,1)*class_cubesize,woodvoxels(:,2)*class_cubesize,woodvoxels(:,3)*class_cubesize,<span class="string">'b.'</span>);<span class="keyword">end</span>; <span class="keyword">end</span>

    axis <span class="string">equal</span>
    view(116,18)
    saveas(gcf,[testdir,<span class="string">'AXBAMnC_Test'</span>,testnum,<span class="string">'Scan'</span>,scannum,<span class="string">'_directedscanAFTER.fig'</span>]);
    close <span class="string">gcf</span>
    display([<span class="string">'Size of ocgrid IS '</span>,num2str(size(workspace.ocgrid)),<span class="string">' with unknown number='</span>,num2str(size(UNclassifiedvoxels))])

<span class="comment">% before</span>
    figure
    plotdenso(r,AXBAMnCtestdata.newQ)
    camlight
    plotfill=false;
    plot_planes(AXBAMnCtestdata.plane_aimed_at,AXBAMnCtestdata.mew,plotfill);
    hold <span class="string">on</span>;
    plot3(AXBAMnCtestdata.plane_aimed_at.home_point(1),AXBAMnCtestdata.plane_aimed_at.home_point(2),AXBAMnCtestdata.plane_aimed_at.home_point(3),<span class="string">'b*'</span>);
    plot3([AXBAMnCtestdata.plane_aimed_at.home_point(1),AXBAMnCtestdata.plane_aimed_at.home_point(1)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(1)/10],<span class="keyword">...</span>
          [AXBAMnCtestdata.plane_aimed_at.home_point(2),AXBAMnCtestdata.plane_aimed_at.home_point(2)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(2)/10],<span class="keyword">...</span>
          [AXBAMnCtestdata.plane_aimed_at.home_point(3),AXBAMnCtestdata.plane_aimed_at.home_point(3)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(3)/10],<span class="string">'b'</span>);
    Pworkspace=AXBAMnCtestdata.Pworkspace;
        <span class="comment">%determine the unknown places and the know metal or wood</span>
    sumofclass=Pworkspace.ocgrid(:,4)+Pworkspace.ocgrid(:,5);
    warning(<span class="string">'off'</span>,<span class="string">'MATLAB:divideByZero'</span>)
    <span class="keyword">try</span> classifiedvoxelsP=find(sumofclass&gt;=Pworkspace.minclassifications &amp;<span class="keyword">...</span>
                         (Pworkspace.ocgrid(:,4)./Pworkspace.ocgrid(:,5)&gt;Pworkspace.classfierthreshhold |<span class="keyword">...</span>
                          Pworkspace.ocgrid(:,5)./Pworkspace.ocgrid(:,4)&gt;Pworkspace.classfierthreshhold));<span class="keyword">end</span>
    <span class="keyword">try</span> UNclassifiedvoxelsP=find(sumofclass&lt;Pworkspace.minclassifications | <span class="keyword">...</span>
                         (Pworkspace.ocgrid(:,4)./Pworkspace.ocgrid(:,5)&lt;=Pworkspace.classfierthreshhold &amp;<span class="keyword">...</span>
                          Pworkspace.ocgrid(:,5)./Pworkspace.ocgrid(:,4)&lt;=Pworkspace.classfierthreshhold));<span class="keyword">end</span>
    warning(<span class="string">'on'</span>,<span class="string">'MATLAB:divideByZero'</span>)

    <span class="comment">%now plot this</span>
    hold <span class="string">on</span>;
    <span class="keyword">if</span> plotunknown
        <span class="keyword">try</span> plot3(Pworkspace.ocgrid(UNclassifiedvoxelsP,1)*class_cubesize,<span class="keyword">...</span>
              Pworkspace.ocgrid(UNclassifiedvoxelsP,2)*class_cubesize,<span class="keyword">...</span>
              Pworkspace.ocgrid(UNclassifiedvoxelsP,3)*class_cubesize,<span class="string">'y'</span>,<span class="string">'marker'</span>,<span class="string">'.'</span>,<span class="string">'markersize'</span>,0.5,<span class="string">'linestyle'</span>,<span class="string">'none'</span>);<span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">%plot metal and wood voxels</span>

    metalvoxels=Pworkspace.ocgrid(classifiedvoxelsP(Pworkspace.ocgrid(classifiedvoxelsP,4)&gt;Pworkspace.ocgrid(classifiedvoxelsP,5)),1:3);
    <span class="keyword">if</span> size(metalvoxels,1)&gt;0
        <span class="keyword">try</span> plot3(metalvoxels(:,1)*class_cubesize,metalvoxels(:,2)*class_cubesize,metalvoxels(:,3)*class_cubesize,<span class="string">'r.'</span>);<span class="keyword">end</span>
    <span class="keyword">end</span>

    woodvoxels=Pworkspace.ocgrid(classifiedvoxelsP(Pworkspace.ocgrid(classifiedvoxelsP,4)&lt;Pworkspace.ocgrid(classifiedvoxelsP,5)),1:3);
    <span class="keyword">if</span> size(woodvoxels,1)&gt;0
        <span class="keyword">try</span> plot3(woodvoxels(:,1)*class_cubesize,woodvoxels(:,2)*class_cubesize,woodvoxels(:,3)*class_cubesize,<span class="string">'b.'</span>);<span class="keyword">end</span>
    <span class="keyword">end</span>


    axis <span class="string">equal</span>
    view(116,18)
    saveas(gcf,[testdir,<span class="string">'AXBAMnC_Test'</span>,testnum,<span class="string">'Scan'</span>,scannum,<span class="string">'_directedscanBEFORE.fig'</span>]);
    close <span class="string">gcf</span>
    display([<span class="string">'Size of ocgrid WAS '</span>,num2str(size(Pworkspace.ocgrid)),<span class="string">' with unknown number='</span>,num2str(size(UNclassifiedvoxelsP))])
    save([testdir,<span class="string">'AXBAMnC_Test'</span>,testnum,<span class="string">'Scan'</span>,scannum,<span class="string">'_workspacePREV_STATE.mat'</span>],<span class="string">'Pworkspace'</span>);
<span class="keyword">end</span>
</pre><p class="footer"><br>
            Published with MATLAB&reg; 7.4<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
function AXBAMnCtesting(plotdirectedC)
%plot the current mesh and robot
global r Q robmap_h workspace
if nargin==0
    plotdirectedC=input('Do you want to plot the directed classification? 1=Yes, 0=No');
    try if plotdirectedC~=1 && plotdirectedC~=0
        plotdirectedC=false;
        end
    catch;
        plotdirectedC=false;
    end
end

testnum= input('Please enter TEST number','s');
scannum= input('Please enter SCAN number','s');
plotunknown=input('Do you want to plot the unknown voxels 1=yes, 0=no');
    
testdir='C:\Documents and Settings\RTA computer\My Documents\My Pictures\';

%% plot the current mesh and robot
figure
plotdenso(r,Q)
camlight
aabb = [-1.5, -1.5, -1; 2, 1.5, 2];
hMesh = robmap_h.Mesh(aabb);
f = hMesh.FaceData;
v = hMesh.VertexData;
hold on;
guiglobal.mesh_h=trisurf(f, v(:,1), v(:,2), v(:,3), 'FaceColor', 'None');
axis equal
view(116,18)
saveas(gcf,[testdir,'AXBAMnC_Test',testnum,'Scan',scannum,'_meshNrobot.fig']);
close gcf
%% plot the current classification and robot
figure
plotdenso(r,Q)
camlight
class_cubesize=workspace.class_cubesize;
    
    %determine the unknown places and the know metal or wood
sumofclass=workspace.ocgrid(:,4)+workspace.ocgrid(:,5);
warning('off','MATLAB:divideByZero')
try classifiedvoxels=find(sumofclass>=workspace.minclassifications &...
                     (workspace.ocgrid(:,4)./workspace.ocgrid(:,5)>workspace.classfierthreshhold |...
                      workspace.ocgrid(:,5)./workspace.ocgrid(:,4)>workspace.classfierthreshhold));end
try UNclassifiedvoxels=find(sumofclass<workspace.minclassifications | ...
                     (workspace.ocgrid(:,4)./workspace.ocgrid(:,5)<=workspace.classfierthreshhold &...
                      workspace.ocgrid(:,5)./workspace.ocgrid(:,4)<=workspace.classfierthreshhold));end
warning('on','MATLAB:divideByZero')
    
    %now plot this
hold on;
if plotunknown
    try plot3(workspace.ocgrid(UNclassifiedvoxels,1)*class_cubesize,...
          workspace.ocgrid(UNclassifiedvoxels,2)*class_cubesize,...
          workspace.ocgrid(UNclassifiedvoxels,3)*class_cubesize,'y','marker','.','markersize',0.5,'linestyle','none');end
end
%plot metal and wood voxels

metalvoxels=workspace.ocgrid(classifiedvoxels(workspace.ocgrid(classifiedvoxels,4)>workspace.ocgrid(classifiedvoxels,5)),1:3);
if size(metalvoxels,1)>0
    try plot3(metalvoxels(:,1)*class_cubesize,metalvoxels(:,2)*class_cubesize,metalvoxels(:,3)*class_cubesize,'r.');end
end

woodvoxels=workspace.ocgrid(classifiedvoxels(workspace.ocgrid(classifiedvoxels,4)<workspace.ocgrid(classifiedvoxels,5)),1:3);
if size(woodvoxels,1)>0
    try plot3(woodvoxels(:,1)*class_cubesize,woodvoxels(:,2)*class_cubesize,woodvoxels(:,3)*class_cubesize,'b.');end
end

  
axis equal
view(116,18)
saveas(gcf,[testdir,'AXBAMnC_Test',testnum,'Scan',scannum,'_classNrobot.fig']);
close gcf

%% save the workspace data file at that point
save([testdir,'AXBAMnC_Test',testnum,'Scan',scannum,'_workspaceSTATE.mat'],'workspace');

%% plot directed C
global AXBAMnCtestdata
if plotdirectedC && ~isempty(AXBAMnCtestdata)
%after (uses previous steps found metal and wood)
    figure
    plotdenso(r,AXBAMnCtestdata.newQ)
    camlight
    plotfill=false;
    plot_planes(AXBAMnCtestdata.plane_aimed_at,AXBAMnCtestdata.mew,plotfill);        
    hold on;
    plot3(AXBAMnCtestdata.plane_aimed_at.home_point(1),AXBAMnCtestdata.plane_aimed_at.home_point(2),AXBAMnCtestdata.plane_aimed_at.home_point(3),'b*');
    plot3([AXBAMnCtestdata.plane_aimed_at.home_point(1),AXBAMnCtestdata.plane_aimed_at.home_point(1)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(1)/10],...
          [AXBAMnCtestdata.plane_aimed_at.home_point(2),AXBAMnCtestdata.plane_aimed_at.home_point(2)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(2)/10],...
          [AXBAMnCtestdata.plane_aimed_at.home_point(3),AXBAMnCtestdata.plane_aimed_at.home_point(3)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(3)/10],'b');                                   
    if plotunknown   
        try plot3(workspace.ocgrid(UNclassifiedvoxels,1)*class_cubesize,...
          workspace.ocgrid(UNclassifiedvoxels,2)*class_cubesize,...
          workspace.ocgrid(UNclassifiedvoxels,3)*class_cubesize,'y','marker','.','markersize',0.5,'linestyle','none');end
    end
    if size(metalvoxels,1)>0;try plot3(metalvoxels(:,1)*class_cubesize,metalvoxels(:,2)*class_cubesize,metalvoxels(:,3)*class_cubesize,'r.');end; end
    if size(woodvoxels,1)>0;try plot3(woodvoxels(:,1)*class_cubesize,woodvoxels(:,2)*class_cubesize,woodvoxels(:,3)*class_cubesize,'b.');end; end

    axis equal
    view(116,18)
    saveas(gcf,[testdir,'AXBAMnC_Test',testnum,'Scan',scannum,'_directedscanAFTER.fig']);
    close gcf
    display(['Size of ocgrid IS ',num2str(size(workspace.ocgrid)),' with unknown number=',num2str(size(UNclassifiedvoxels))])
    
% before
    figure
    plotdenso(r,AXBAMnCtestdata.newQ)
    camlight
    plotfill=false;
    plot_planes(AXBAMnCtestdata.plane_aimed_at,AXBAMnCtestdata.mew,plotfill);        
    hold on;
    plot3(AXBAMnCtestdata.plane_aimed_at.home_point(1),AXBAMnCtestdata.plane_aimed_at.home_point(2),AXBAMnCtestdata.plane_aimed_at.home_point(3),'b*');
    plot3([AXBAMnCtestdata.plane_aimed_at.home_point(1),AXBAMnCtestdata.plane_aimed_at.home_point(1)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(1)/10],...
          [AXBAMnCtestdata.plane_aimed_at.home_point(2),AXBAMnCtestdata.plane_aimed_at.home_point(2)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(2)/10],...
          [AXBAMnCtestdata.plane_aimed_at.home_point(3),AXBAMnCtestdata.plane_aimed_at.home_point(3)+AXBAMnCtestdata.plane_aimed_at.normal_by_eigenval(3)/10],'b');                                   
    Pworkspace=AXBAMnCtestdata.Pworkspace;
        %determine the unknown places and the know metal or wood
    sumofclass=Pworkspace.ocgrid(:,4)+Pworkspace.ocgrid(:,5);
    warning('off','MATLAB:divideByZero')
    try classifiedvoxelsP=find(sumofclass>=Pworkspace.minclassifications &...
                         (Pworkspace.ocgrid(:,4)./Pworkspace.ocgrid(:,5)>Pworkspace.classfierthreshhold |...
                          Pworkspace.ocgrid(:,5)./Pworkspace.ocgrid(:,4)>Pworkspace.classfierthreshhold));end
    try UNclassifiedvoxelsP=find(sumofclass<Pworkspace.minclassifications | ...
                         (Pworkspace.ocgrid(:,4)./Pworkspace.ocgrid(:,5)<=Pworkspace.classfierthreshhold &...
                          Pworkspace.ocgrid(:,5)./Pworkspace.ocgrid(:,4)<=Pworkspace.classfierthreshhold));end
    warning('on','MATLAB:divideByZero')

    %now plot this
    hold on;
    if plotunknown
        try plot3(Pworkspace.ocgrid(UNclassifiedvoxelsP,1)*class_cubesize,...
              Pworkspace.ocgrid(UNclassifiedvoxelsP,2)*class_cubesize,...
              Pworkspace.ocgrid(UNclassifiedvoxelsP,3)*class_cubesize,'y','marker','.','markersize',0.5,'linestyle','none');end
    end
    %plot metal and wood voxels

    metalvoxels=Pworkspace.ocgrid(classifiedvoxelsP(Pworkspace.ocgrid(classifiedvoxelsP,4)>Pworkspace.ocgrid(classifiedvoxelsP,5)),1:3);
    if size(metalvoxels,1)>0
        try plot3(metalvoxels(:,1)*class_cubesize,metalvoxels(:,2)*class_cubesize,metalvoxels(:,3)*class_cubesize,'r.');end
    end

    woodvoxels=Pworkspace.ocgrid(classifiedvoxelsP(Pworkspace.ocgrid(classifiedvoxelsP,4)<Pworkspace.ocgrid(classifiedvoxelsP,5)),1:3);
    if size(woodvoxels,1)>0
        try plot3(woodvoxels(:,1)*class_cubesize,woodvoxels(:,2)*class_cubesize,woodvoxels(:,3)*class_cubesize,'b.');end
    end

    
    axis equal
    view(116,18)
    saveas(gcf,[testdir,'AXBAMnC_Test',testnum,'Scan',scannum,'_directedscanBEFORE.fig']);
    close gcf
    display(['Size of ocgrid WAS ',num2str(size(Pworkspace.ocgrid)),' with unknown number=',num2str(size(UNclassifiedvoxelsP))])
    save([testdir,'AXBAMnC_Test',testnum,'Scan',scannum,'_workspacePREV_STATE.mat'],'Pworkspace');
end

##### SOURCE END #####
-->
   </body>
</html>
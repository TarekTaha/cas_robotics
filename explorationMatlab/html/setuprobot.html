
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>setuprobot</title>
      <meta name="generator" content="MATLAB 7.4">
      <meta name="date" content="2007-10-05">
      <meta name="m-file" content="setuprobot"><style>

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content">
         <h1>setuprobot</h1>
         <introduction>
            <p><b>Description:</b> This sets up the robot, nothing needs to have been declared before this Sets up the robot (r), Joint positions Q, and densoobj
               which is for force fielding, and plotting
            </p>
         </introduction>
         <h2>Contents</h2>
         <div>
            <ul>
               <li><a href="#1">Function Call</a></li>
               <li><a href="#2">Variables</a></li>
               <li><a href="#3">Load model, add laser, Calcellipses to go around each robot piece</a></li>
               <li><a href="#4">Speed up variables for NBV</a></li>
               <li><a href="#5">Tag onto this var the scan/move speed of robot (should put in densoobj)</a></li>
            </ul>
         </div>
         <h2>Function Call<a name="1"></a></h2>
         <p><b>Inputs:</b> NULL
         </p>
         <p><b>Returns:</b> NULL
         </p><pre class="codeinput"><span class="keyword">function</span> setuprobot()
</pre><h2>Variables<a name="2"></a></h2><pre class="codeinput"><span class="keyword">global</span> Q r densoobj robot_maxreach;

<span class="comment">%New robot - start pose</span>
Q=[0,-75,165,0,30,0]*pi/180;
<span class="comment">% Default poses - add additional ones as needed</span>
default_Q=[Q;[0,-88*pi/180,140*pi/180,0,-15*pi/180,0]];
default_Q=[default_Q;[0,-88*pi/180,98*pi/180,0,-15*pi/180,0]];
robot_maxreach.default_Q=default_Q;

<span class="comment">%this is the robot object you wish to use</span>
<span class="keyword">try</span> r = feval(<span class="string">'rob_object'</span>);
<span class="keyword">catch</span>
    error(<span class="string">'Cant setup robot object'</span>);
<span class="keyword">end</span>
</pre><h2>Load model, add laser, Calcellipses to go around each robot piece<a name="3"></a></h2><pre class="codeinput"><span class="comment">%this loads the model used and calculates the elipses</span>
<span class="comment">% MAKE SURE DENSOOBJ.mat has a variable called densoobj !!</span>
load <span class="string">densoobj.mat</span>
<span class="comment">%CHANGE last peice so it sort of has the laser on it</span>
densoobj(7).M(find(densoobj(7).M(:,3)&gt;=-0.001 &amp; densoobj(7).M(:,1)&lt;0),3)=0.12;

<span class="keyword">for</span> piece=1:size(densoobj,2)
    [densoobj(piece).ellipse.x,densoobj(piece).ellipse.y,densoobj(piece).ellipse.z,<span class="keyword">...</span>
        densoobj(piece).ellipse.params, densoobj(piece).ellipse.center]=calc_elip(piece,densoobj(piece).M);
<span class="keyword">end</span>
</pre><h2>Speed up variables for NBV<a name="4"></a></h2><pre class="codeinput"><span class="comment">%this is used to make the NBV quicker so it will only try realistic points</span>
<span class="comment">%we know that the max reach from the first joint (swivel) is max about 1.1</span>
<span class="comment">%meters so don't even try anything that is larger than that</span>

robot_maxreach.val=1.15;

n = r.n;
L = r.link;
t = r.base;
t = t * L{1}(Q(1));
robot_maxreach.firstlinkpos=[0,t(2:3,4)'];
</pre><h2>Tag onto this var the scan/move speed of robot (should put in densoobj)<a name="5"></a></h2><pre class="codeinput">robot_maxreach.scan_speed=10;
robot_maxreach.move_speed=60;
</pre><p class="footer"><br>
            Published with MATLAB&reg; 7.4<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% setuprobot
%
% *Description:* This sets up the robot, nothing needs to have been declared before this
% Sets up the robot (r), Joint positions Q, 
% and densoobj which is for force fielding, and plotting

%% Function Call
% 
% *Inputs:* NULL
%
% *Returns:* NULL

function setuprobot()

%% Variables
global Q r densoobj robot_maxreach;

%New robot - start pose
Q=[0,-75,165,0,30,0]*pi/180;
% Default poses - add additional ones as needed
default_Q=[Q;[0,-88*pi/180,140*pi/180,0,-15*pi/180,0]];
default_Q=[default_Q;[0,-88*pi/180,98*pi/180,0,-15*pi/180,0]];
robot_maxreach.default_Q=default_Q;

%this is the robot object you wish to use
try r = feval('rob_object');
catch
    error('Cant setup robot object');
end

%% Load model, add laser, Calcellipses to go around each robot piece

%this loads the model used and calculates the elipses
% MAKE SURE DENSOOBJ.mat has a variable called densoobj !!
load densoobj.mat
%CHANGE last peice so it sort of has the laser on it
densoobj(7).M(find(densoobj(7).M(:,3)>=-0.001 & densoobj(7).M(:,1)<0),3)=0.12;

for piece=1:size(densoobj,2)
    [densoobj(piece).ellipse.x,densoobj(piece).ellipse.y,densoobj(piece).ellipse.z,...
        densoobj(piece).ellipse.params, densoobj(piece).ellipse.center]=calc_elip(piece,densoobj(piece).M);
end

%% Speed up variables for NBV
%this is used to make the NBV quicker so it will only try realistic points
%we know that the max reach from the first joint (swivel) is max about 1.1
%meters so don't even try anything that is larger than that

robot_maxreach.val=1.15;

n = r.n;
L = r.link;
t = r.base;
t = t * L{1}(Q(1));
robot_maxreach.firstlinkpos=[0,t(2:3,4)'];

%% Tag onto this var the scan/move speed of robot (should put in densoobj)

robot_maxreach.scan_speed=10;
robot_maxreach.move_speed=60;
##### SOURCE END #####
-->
   </body>
</html>